{
    "session_dir": "pretrained",
    "initialize": {
        "definitions": [
            {
                "group": "datasets",
                "name": "train_ds",
                "spec": {
                    "class": "torchvision.datasets.MNIST",
                    "args": ["data"],
                    "kwargs": {
                        "train": true,
                        "download": true
                    }
                }
            },
            {
                "group": "datasets",
                "name": "test_ds",
                "spec": {
                    "class": "torchvision.datasets.MNIST",
                    "args": ["data"],
                    "kwargs": {
                        "train": false,
                        "download": true
                    }
                }
            },
            {
                "group": "collators",
                "name": "my_collator",
                "spec": {
                    "class": "examples.mnist.MyCollator"
                }
            },
            {
                "group": "data_loaders",
                "name": "training_loader",
                "spec": {
                    "dataset": "train_ds",
                    "collator": "my_collator",
                    "kwargs": {
                        "batch_size": 32,
                        "num_workers": 2
                    }
                }
            },
            {
                "group": "data_loaders",
                "name": "test_loader",
                "spec": {
                    "dataset": "test_ds",
                    "collator": "my_collator",
                    "kwargs": {
                        "batch_size": 32,
                        "num_workers": 2
                    }
                }
            },
            {
                "group": "models",
                "name": "LeNet5",
                "spec": {
                    "class": "examples.mnist.LeNet5"
                }
            },
            {
                "group": "optimizers",
                "name": "optimizer",
                "spec": {
                    "class": "Adam",
                    "kwargs": {
                        "lr": 0.001
                    },
                    "model": "LeNet5"
                }
            },
            {
                "group": "losses",
                "name": "cross_entropy",
                "spec": {
                    "class": "CrossEntropyLoss",
                    "inputs": ["y_hat", "input_2"],
                    "transform": "examples.mnist.convert_labels"
                }
            },
            {
                "group": "metrics",
                "name": "accuracy",
                "spec": {
                    "class": "Accuracy",
                    "inputs": ["y_hat", "input_2"],
                    "transform": "examples.mnist.reverse_onehot"
                }
            }
        ]
    }
}